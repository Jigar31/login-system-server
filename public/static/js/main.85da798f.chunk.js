(this["webpackJsonplogin-system"]=this["webpackJsonplogin-system"]||[]).push([[0],{101:function(e,t,a){"use strict";a.r(t);var n=a(2),s=a(0),r=a.n(s),c=a(8),i=a.n(c),l=(a(76),a(77),a(19)),o=a.n(l),d=a(27),u=a(10),j=a(131),b=a(132),p=a(20),m=a.n(p);a(60);var f=function(e){var t=Object(s.useState)(""),a=Object(u.a)(t,2),r=a[0],c=a[1],i=Object(s.useState)(""),l=Object(u.a)(i,2),p=l[0],f=l[1],h=Object(s.useState)(!1),O=Object(u.a)(h,2),x=O[0],v=O[1];localStorage.removeItem("token"),localStorage.removeItem("userId");var g=function(){var t=Object(d.a)(o.a.mark((function t(a){var n,s;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),v(!1),t.prev=2,t.next=5,m.a.post("api/login",{username:r,password:p});case 5:n=t.sent,s=n.data.userId,localStorage.setItem("userId",s),e.history.push("/home"),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(2),console.error(t.t0),v(!0);case 15:case"end":return t.stop()}}),t,null,[[2,11]])})));return function(e){return t.apply(this,arguments)}}();return Object(n.jsxs)("div",{className:"login container",children:[Object(n.jsx)("h3",{className:"heading",children:"Login"}),x&&Object(n.jsx)("div",{className:"error-alert alert",children:"Invalid username or password"}),Object(n.jsxs)("form",{className:"login-form",onSubmit:function(e){return g(e)},children:[Object(n.jsx)("div",{className:"form-field",children:Object(n.jsx)(j.a,{id:"username",label:"Username",variant:"outlined",type:"text",onChange:function(e){c(e.target.value)}})}),Object(n.jsx)("div",{className:"form-field",children:Object(n.jsx)(j.a,{id:"password",label:"Password",variant:"outlined",type:"password",onChange:function(e){f(e.target.value)}})}),Object(n.jsx)("div",{className:"form-button",children:Object(n.jsx)(b.a,{variant:"contained",color:"primary",type:"submit",children:"Login"})})]}),Object(n.jsxs)("div",{className:"signup-block",children:[Object(n.jsx)("p",{children:"Not registered user?"}),Object(n.jsx)("span",{className:"link",onClick:function(){e.history.push("/signup")},children:"Signup"})]})]})},h=a(40),O=a(35),x=a(11),v=a(133),g=a(30);var y=Object(g.b)((function(e){return{user:e}}),(function(e){return{updateUser:function(t){return e({type:"UPDATE_USER",payload:t})}}}))((function(e){var t=Object(s.useState)(""),a=Object(u.a)(t,2),r=a[0],c=a[1],i=Object(s.useState)(""),l=Object(u.a)(i,2),p=l[0],f=l[1],g=Object(s.useState)(""),y=Object(u.a)(g,2),N=y[0],S=y[1],L=Object(s.useState)(""),P=Object(u.a)(L,2),k=P[0],w=P[1],C=Object(s.useState)(""),I=Object(u.a)(C,2),U=I[0],F=I[1],E=Object(s.useState)(""),A=Object(u.a)(E,2),R=A[0],T=A[1],D=Object(s.useState)({addressLine1:"",addressLine2:"",city:"",state:"",pincode:""}),V=Object(u.a)(D,2),_=V[0],J=V[1],M=Object(s.useState)(""),z=Object(u.a)(M,2),B=z[0],q=z[1],G=Object(s.useState)(0),H=Object(u.a)(G,2),K=H[0],Q=H[1],W=Object(s.useState)(!1),X=Object(u.a)(W,2),Y=X[0],Z=X[1],$=Object(s.useState)(!1),ee=Object(u.a)($,2),te=ee[0],ae=ee[1],ne=Object(s.useState)(""),se=Object(u.a)(ne,2),re=se[0],ce=se[1],ie=Object(s.useState)(null),le=Object(u.a)(ie,2),oe=le[0],de=le[1],ue=Object(s.useState)(null),je=Object(u.a)(ue,2),be=je[0],pe=je[1],me=Object(x.f)(),fe=e.user,he=e.userImage,Oe=e.setEdit,xe=e.setProfileImage,ve=e.isSignup,ge=localStorage.getItem("userId");Object(s.useEffect)((function(){he&&de(he),ve||(c(fe.username),f(fe.password),S(fe.firstname),w(fe.lastname),F(fe.age),T(fe.phone),q(fe.profilePicture),Q(fe.profilePictureVersion),J({addressLine1:fe.address.addressLine1,addressLine2:fe.address.addressLine2,city:fe.address.city,state:fe.address.state,pincode:fe.address.pincode}))}),[]);var ye=function(){var t=Object(d.a)(o.a.mark((function t(a){var n,s,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),Z(!1),ae(!1),t.prev=3,""===r||""===N||""===k||""===U||""===R||""===B){t.next=26;break}if(!ve){t.next=11;break}return t.next=8,m.a.post("api/signup",{username:r,password:p,firstname:N,lastname:k,age:U,phone:R,address:_,profilePicture:B,profilePictureVersion:K});case 8:me.push("/login"),t.next=24;break;case 11:return console.log("update"),t.next=14,m.a.patch("api/user",{userId:ge,username:r,password:p,firstname:N,lastname:k,age:U,phone:R,address:_,profilePicture:B,profilePictureVersion:K});case 14:return n=t.sent,console.log(n),s=JSON.parse(n.config.data),e.updateUser(s),t.next=20,m.a.get("/api/user/".concat(s.userId,"/").concat(s.profilePictureVersion,"/").concat(s.profilePicture),{responseType:"blob"});case 20:c=t.sent,xe(URL.createObjectURL(c.data)),Oe(!1),me.push("/home");case 24:t.next=28;break;case 26:ae(!0),ce("Please fill all fields and upload profile picture");case 28:t.next=34;break;case 30:t.prev=30,t.t0=t.catch(3),console.error(t.t0),Z(!0);case 34:case"end":return t.stop()}}),t,null,[[3,30]])})));return function(e){return t.apply(this,arguments)}}(),Ne=function(){var e=Object(d.a)(o.a.mark((function e(){var t,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=new FormData,console.log("file:",be),!be){e.next=9;break}return t.append("profilePicture",be,be.name),e.next=6,m.a.post("api/upload/profilePicture",t);case 6:a=e.sent,q(a.data.filename),console.log("profilePicture:",B);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Se=function(e){J(Object(O.a)(Object(O.a)({},_),{},Object(h.a)({},e.target.name,e.target.value)))};return Object(n.jsxs)("div",{children:[Y&&Object(n.jsx)("div",{className:"error-alert alert",children:"Technical Error occured!"}),te&&Object(n.jsx)("div",{className:"error-alert alert",children:re}),Object(n.jsxs)("form",{className:"signup-form",children:[Object(n.jsxs)("div",{className:"profile-picture-container",children:[Object(n.jsxs)("label",{htmlFor:"profile-picture",children:[Object(n.jsx)("input",{id:"profile-picture",style:{display:"none"},type:"file",onChange:function(e){console.log("file changed"),pe(e.target.files[0]),de(URL.createObjectURL(e.target.files[0]))}}),Object(n.jsx)(v.a,{src:oe,style:{height:"100px",width:"100px"}})]}),Object(n.jsx)("br",{}),Object(n.jsx)(b.a,{size:"small",variant:"contained",color:"primary",type:"button",onClick:Ne,children:"Upload Photo"})]}),Object(n.jsxs)("div",{className:"form-fields",children:[Object(n.jsx)("div",{className:"form-field",children:Object(n.jsx)(j.a,{id:"username",label:"Username",variant:"outlined",type:"text",value:r,onChange:function(e){c(e.target.value)}})}),Object(n.jsx)("div",{className:"form-field",children:Object(n.jsx)(j.a,{id:"password",label:"Password",variant:"outlined",type:"password",onChange:function(e){f(e.target.value)}})}),Object(n.jsx)("div",{className:"form-field",children:Object(n.jsx)(j.a,{id:"firstname",label:"Firstname",variant:"outlined",type:"text",value:N,onChange:function(e){S(e.target.value)}})}),Object(n.jsx)("div",{className:"form-field",children:Object(n.jsx)(j.a,{id:"lastname",label:"Lastname",variant:"outlined",type:"text",value:k,onChange:function(e){w(e.target.value)}})}),Object(n.jsx)("div",{className:"form-field",children:Object(n.jsx)(j.a,{id:"age",label:"Age",variant:"outlined",inputMode:"numeric",value:U,onChange:function(e){F(e.target.value)}})}),Object(n.jsx)("div",{className:"form-field",children:Object(n.jsx)(j.a,{id:"phone",label:"Phone",variant:"outlined",inputMode:"numeric",value:R,onChange:function(e){T(e.target.value)}})}),Object(n.jsx)("div",{className:"form-field",children:Object(n.jsx)(j.a,{id:"addressLine1",name:"addressLine1",label:"AddressLine1",variant:"outlined",type:"text",value:_.addressLine1,onChange:function(e){Se(e)}})}),Object(n.jsx)("div",{className:"form-field",children:Object(n.jsx)(j.a,{id:"addressLine2",name:"addressLine2",label:"AddressLine2",variant:"outlined",type:"text",value:_.addressLine2,onChange:function(e){Se(e)}})}),Object(n.jsx)("div",{className:"form-field",children:Object(n.jsx)(j.a,{id:"city",name:"city",label:"City",variant:"outlined",type:"text",value:_.city,onChange:function(e){Se(e)}})}),Object(n.jsx)("div",{className:"form-field",children:Object(n.jsx)(j.a,{id:"state",name:"state",label:"State",variant:"outlined",type:"text",value:_.state,onChange:function(e){Se(e)}})}),Object(n.jsx)("div",{className:"form-field",children:Object(n.jsx)(j.a,{id:"pincode",name:"pincode",label:"Pincode",variant:"outlined",type:"text",value:_.pincode,onChange:function(e){Se(e)}})})]}),Object(n.jsx)("div",{className:"sign-up-button",children:Object(n.jsx)("div",{className:"form-button",children:Object(n.jsxs)(b.a,{size:"large",variant:"contained",color:"primary",type:"submit",onClick:ye,children:[ve&&"Signup",!ve&&"Update"]})})})]})]})}));var N=function(e){return Object(n.jsxs)("div",{className:"signup-container container",children:[Object(n.jsx)("h3",{className:"heading",children:"Signup"}),Object(n.jsxs)("p",{children:["Already a registered user?\xa0",Object(n.jsx)("span",{className:"link",onClick:function(){e.history.push("/login")},children:"Login"})]}),Object(n.jsx)(y,{isSignup:!0})]})};var S=Object(g.b)((function(e){return{user:e}}),(function(e,t){return{updateUser:function(t){return e({type:"UPDATE_USER",payload:t})}}}))((function(e){var t=localStorage.getItem("userId"),a=e.user,r=e.updateUser,c=Object(s.useState)(null),i=Object(u.a)(c,2),l=i[0],j=i[1],b=Object(s.useState)(!1),p=Object(u.a)(b,2),f=p[0],h=p[1];Object(s.useEffect)((function(){O()}),[]);var O=function(){var e=Object(d.a)(o.a.mark((function e(){var a,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=10;break}return e.next=3,m.a.get("/api/user/".concat(t));case 3:return a=e.sent,console.log(a.data),r(a.data),e.next=8,m.a.get("/api/user/".concat(a.data._id,"/").concat(a.data.profilePictureVersion,"/").concat(a.data.profilePicture),{responseType:"blob"});case 8:n=e.sent,j(URL.createObjectURL(n.data));case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return t?Object(n.jsxs)("div",{className:"profile-container container",children:[Object(n.jsx)("h3",{className:"heading",children:"Profile"}),!f&&Object(n.jsx)("span",{className:"link edit",onClick:function(){h(!0)},children:"Edit Profile"}),Object(n.jsx)("span",{className:"link logout",onClick:function(){localStorage.removeItem("userId"),e.history.push("/login")},children:"Logout"}),!f&&Object(n.jsxs)("div",{className:"user-profile",children:[Object(n.jsx)("div",{className:"user-profile-picture",children:Object(n.jsx)(v.a,{src:l,style:{height:"100px",width:"100px"}})}),Object(n.jsxs)("div",{className:"user-info",children:[Object(n.jsxs)("div",{className:"username",children:[Object(n.jsx)("label",{htmlFor:"username",children:"Username:"}),Object(n.jsx)("p",{id:"username",children:a.username})]}),Object(n.jsxs)("div",{className:"firstname",children:[Object(n.jsx)("label",{htmlFor:"firstname",children:"Firstname:"}),Object(n.jsx)("p",{id:"firstname",children:a.firstname})]}),Object(n.jsxs)("div",{className:"lastname",children:[Object(n.jsx)("label",{htmlFor:"lastname",children:"Lastname:"}),Object(n.jsx)("p",{id:"lastname",children:a.lastname})]}),Object(n.jsxs)("div",{className:"age",children:[Object(n.jsx)("label",{htmlFor:"age",children:"Age:"}),Object(n.jsx)("p",{id:"age",children:a.age})]}),Object(n.jsxs)("div",{className:"phone",children:[Object(n.jsx)("label",{htmlFor:"phone",children:"Phone:"}),Object(n.jsx)("p",{id:"phone",children:a.phone})]}),Object(n.jsxs)("div",{className:"address",children:[Object(n.jsx)("label",{htmlFor:"address",children:"Address:"}),Object(n.jsx)("p",{id:"address",children:a.address&&"".concat(a.address.addressLine1,", ").concat(a.address.addressLine2,", ").concat(a.address.city,", ").concat(a.address.state,", Pincode - ").concat(a.address.pincode)})]})]})]}),f&&Object(n.jsx)(y,{user:a,userImage:l,setEdit:h,setProfileImage:j})]}):(e.history.push("/login"),null)})),L=a(46);var P=function(){return Object(n.jsx)("div",{className:"App",children:Object(n.jsx)(L.a,{children:Object(n.jsxs)(x.c,{children:[Object(n.jsx)(x.a,{path:"/login",component:f}),Object(n.jsx)(x.a,{path:"/signup",component:N}),Object(n.jsx)(x.a,{path:"/home",component:S}),Object(n.jsx)(x.a,{path:"/",component:f})]})})})},k=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,135)).then((function(t){var a=t.getCLS,n=t.getFID,s=t.getFCP,r=t.getLCP,c=t.getTTFB;a(e),n(e),s(e),r(e),c(e)}))},w=a(41),C={userId:"",username:"",firstname:"",lastname:"",age:"",phone:"",address:{addressLine1:"",addressLine2:"",city:"",state:"",pincode:""},profilePicture:"",profilePictureVersion:""},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C,t=arguments.length>1?arguments[1]:void 0,a=Object(O.a)({},e);return"UPDATE_USER"===t.type&&(a=t.payload),a},U=Object(w.b)(I);i.a.render(Object(n.jsx)(r.a.StrictMode,{children:Object(n.jsx)(g.a,{store:U,children:Object(n.jsx)(P,{})})}),document.getElementById("root")),k()},60:function(e,t,a){},76:function(e,t,a){},77:function(e,t,a){}},[[101,1,2]]]);
//# sourceMappingURL=main.85da798f.chunk.js.map